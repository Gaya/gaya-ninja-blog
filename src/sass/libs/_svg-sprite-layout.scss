/*
 * Generate a SVG-sprite mixin for Sass
 * ====================================
 *
 * SVGSprite is a wonderful package, but doesn't enable responsive sprites out of the box.
 * This moustache template generates a sass file with a mixin for the generated SVG-sprite.
 * Calculates the position and size of the background by filename.
 * Included SVG image scales to width and height.
 *
 * Usage:
 * ======
 * 1. In the SVGSprite options put the template in the `render` property:
 *
 * render: {
 *      sass: {
 *          template: 'svg-sprite-layout.scss',
 *          dest: 'path/to/output/svg-sprite.scss'
 *      }
 * }
 *
 * 2. Import the generated .scss file in your Sass project:
 *
 * @import "path/to/output/svg-sprite.scss";
 *
 * 3. Use the SVG image on an element:
 *
 * .element {
 *      @include svg-sprite('name-of-svg-file');
 *      width: 15px;
 *      height: 20px;
 * }
 *
 */

%sprite {
    background-image: url(../{{{sprite}}});
}

@mixin svg-sprite($name) {
    @extend %sprite;

    $total-w: {{ swidth }};
    $total-h: {{ sheight }};

    {{#svg}}
    @if $name == {{name}} {
        $s-w: {{width}};
        $s-h: {{height}};
        $s-y: {{positionY}};
        $s-x: {{positionX}};
        $pos-x: 0;
        $pos-y: 0;

        @if ($total-w - $s-w) != 0 {
            $pos-x: ($s-x * -1) / ($total-w - $s-w);
        }

        @if ($total-h - $s-h) != 0 {
            $pos-y: ($s-y * -1) / ($total-h - $s-h);
        }

        background-size: percentage($total-w / $s-w) percentage($total-h / $s-h);
        background-position: percentage($pos-x) percentage($pos-y);
    }
    {{/svg}}
}